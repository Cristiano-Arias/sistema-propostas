<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise Comparativa Técnica - Sistema de Gestão de Propostas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 250px;
            background: linear-gradient(180deg, #2e7d32 0%, #1b5e20 100%);
            color: white;
            padding: 20px 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .logo {
            text-align: center;
            padding: 0 20px 30px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            margin-bottom: 20px;
        }

        .logo h2 {
            font-size: 18px;
            font-weight: 600;
        }

        .logo p {
            font-size: 12px;
            opacity: 0.8;
            margin-top: 5px;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-title {
            padding: 0 20px;
            font-size: 12px;
            text-transform: uppercase;
            opacity: 0.7;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: white;
            text-decoration: none;
            transition: background-color 0.3s;
            cursor: pointer;
            border: none;
            background: none;
            width: 100%;
            text-align: left;
            font-size: 14px;
        }

        .nav-item:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .nav-item.active {
            background-color: rgba(255,255,255,0.2);
            border-right: 3px solid #4caf50;
        }

        .nav-item .icon {
            margin-right: 10px;
            font-size: 16px;
        }

        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .header h1 {
            color: #2e7d32;
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .analysis-container {
            display: grid;
            gap: 20px;
        }

        .methodology-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .section-title .icon {
            margin-right: 10px;
            font-size: 20px;
        }

        .methodology-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .methodology-card {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .methodology-card:hover {
            border-color: #2e7d32;
            box-shadow: 0 4px 15px rgba(46, 125, 50, 0.1);
        }

        .methodology-card.selected {
            border-color: #2e7d32;
            background: #f1f8e9;
        }

        .methodology-card h3 {
            color: #2e7d32;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .methodology-card p {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .methodology-features {
            list-style: none;
        }

        .methodology-features li {
            font-size: 12px;
            color: #888;
            margin-bottom: 5px;
            padding-left: 15px;
            position: relative;
        }

        .methodology-features li:before {
            content: "✓";
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
        }

        .criteria-section {
            margin-top: 30px;
        }

        .criteria-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .criteria-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid #2e7d32;
        }

        .criteria-item h4 {
            color: #2e7d32;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .criteria-item .weight {
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }

        .criteria-item .description {
            font-size: 12px;
            color: #777;
            line-height: 1.4;
        }

        .proposals-comparison {
            margin-top: 30px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .comparison-table th {
            background: #2e7d32;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .comparison-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .score-cell {
            text-align: center;
            font-weight: 600;
        }

        .score-excellent {
            color: #4caf50;
            background: #e8f5e8;
            border-radius: 4px;
            padding: 5px 10px;
        }

        .score-good {
            color: #ff9800;
            background: #fff3e0;
            border-radius: 4px;
            padding: 5px 10px;
        }

        .score-regular {
            color: #f44336;
            background: #ffebee;
            border-radius: 4px;
            padding: 5px 10px;
        }

        .technical-analysis {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
        }

        .analysis-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .analysis-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .analysis-item h4 {
            color: #2e7d32;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .analysis-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
        }

        .analysis-metrics {
            background: white;
            border-radius: 8px;
            padding: 15px;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .metric:last-child {
            margin-bottom: 0;
        }

        .metric-label {
            color: #666;
        }

        .metric-value {
            font-weight: 600;
            color: #2e7d32;
        }

        .analysis-description {
            background: white;
            border-radius: 8px;
            padding: 15px;
        }

        .analysis-description p {
            color: #555;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .analysis-description p:last-child {
            margin-bottom: 0;
        }

        .recommendation-section {
            background: linear-gradient(135deg, #e8f5e8 0%, #f1f8e9 100%);
            border-radius: 10px;
            padding: 25px;
            margin-top: 30px;
            border: 2px solid #4caf50;
        }

        .recommendation-title {
            color: #2e7d32;
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .recommendation-title .icon {
            margin-right: 10px;
            font-size: 20px;
        }

        .recommendation-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .recommendation-text {
            color: #2e7d32;
            font-size: 14px;
            line-height: 1.6;
        }

        .recommendation-summary {
            background: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .recommended-supplier {
            font-size: 18px;
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 10px;
        }

        .recommendation-score {
            font-size: 24px;
            font-weight: 700;
            color: #4caf50;
            margin-bottom: 5px;
        }

        .recommendation-label {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: flex-end;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #2e7d32;
            color: white;
        }

        .btn-primary:hover {
            background: #1b5e20;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2e7d32;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }
            
            .main-content {
                margin-left: 200px;
            }
            
            .methodology-grid {
                grid-template-columns: 1fr;
            }
            
            .criteria-grid {
                grid-template-columns: 1fr;
            }
            
            .analysis-content {
                grid-template-columns: 1fr;
            }
            
            .recommendation-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 600px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <div class="logo">
                <div style="font-size: 24px; margin-bottom: 5px;">🏢</div>
                <h2>Portal do Comprador</h2>
                <p>Sistema de Gestão de Propostas</p>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">PRINCIPAL</div>
                <button class="nav-item" onclick="navigateTo('dashboard')">
                    <span class="icon">📊</span> Dashboard
                </button>
                <button class="nav-item" onclick="navigateTo('aprovacao-trs')">
                    <span class="icon">📋</span> Aprovação de TRs
                </button>
                <button class="nav-item" onclick="navigateTo('criar-processo')">
                    <span class="icon">🏗️</span> Criar Processo
                </button>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">PROPOSTAS</div>
                <button class="nav-item" onclick="navigateTo('propostas-recebidas')">
                    <span class="icon">📄</span> Propostas Recebidas
                </button>
                <button class="nav-item active" onclick="navigateTo('analise-tecnica')">
                    <span class="icon">🔬</span> Análise Técnica
                </button>
                <button class="nav-item" onclick="navigateTo('analise-comparativa')">
                    <span class="icon">📊</span> Análise Comparativa
                </button>
                <button class="nav-item" onclick="navigateTo('relatorios')">
                    <span class="icon">📈</span> Relatórios
                </button>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">SISTEMA</div>
                <button class="nav-item" onclick="logout()">
                    <span class="icon">🚪</span> Sair
                </button>
            </div>
        </nav>

        <main class="main-content">
            <div class="header">
                <h1>🔬 Análise Comparativa Técnica</h1>
                <p>Avaliação técnica detalhada das propostas recebidas com metodologias avançadas</p>
            </div>

            <div id="loadingSection" class="loading">
                <div class="loading-spinner"></div>
                <p>Carregando análise técnica...</p>
            </div>

            <div id="analysisContent" class="analysis-container" style="display: none;">
                <!-- Seção de Metodologias -->
                <div class="methodology-section">
                    <h2 class="section-title">
                        <span class="icon">⚙️</span>
                        Metodologias de Análise Técnica
                    </h2>
                    
                    <div class="methodology-grid" id="methodologyGrid">
                        <!-- Metodologias serão carregadas aqui -->
                    </div>
                    
                    <div class="criteria-section">
                        <h3 class="section-title">
                            <span class="icon">📋</span>
                            Critérios de Avaliação
                        </h3>
                        <div class="criteria-grid" id="criteriaGrid">
                            <!-- Critérios serão carregados aqui -->
                        </div>
                    </div>
                </div>

                <!-- Seção de Comparação de Propostas -->
                <div class="methodology-section">
                    <h2 class="section-title">
                        <span class="icon">📊</span>
                        Comparação Técnica das Propostas
                    </h2>
                    
                    <div class="proposals-comparison">
                        <table class="comparison-table" id="comparisonTable">
                            <!-- Tabela será carregada aqui -->
                        </table>
                    </div>
                </div>

                <!-- Seção de Análise Detalhada -->
                <div class="methodology-section">
                    <h2 class="section-title">
                        <span class="icon">🔍</span>
                        Análise Técnica Detalhada
                    </h2>
                    
                    <div class="technical-analysis" id="technicalAnalysis">
                        <!-- Análises detalhadas serão carregadas aqui -->
                    </div>
                </div>

                <!-- Seção de Recomendação -->
                <div class="recommendation-section">
                    <h2 class="recommendation-title">
                        <span class="icon">🎯</span>
                        Recomendação Técnica
                    </h2>
                    
                    <div class="recommendation-content" id="recommendationContent">
                        <!-- Recomendação será carregada aqui -->
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="exportAnalysis()">
                        📄 Exportar Análise
                    </button>
                    <button class="btn btn-secondary" onclick="saveAsDraft()">
                        💾 Salvar Rascunho
                    </button>
                    <button class="btn btn-primary" onclick="finalizeAnalysis()">
                        ✅ Finalizar Análise
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Dados das metodologias de análise técnica
        const methodologies = [
            {
                id: 'ahp',
                name: 'AHP - Analytic Hierarchy Process',
                description: 'Metodologia de análise hierárquica que permite comparação par a par dos critérios e alternativas.',
                features: [
                    'Comparação par a par',
                    'Matriz de consistência',
                    'Pesos relativos automáticos',
                    'Análise de sensibilidade'
                ],
                selected: true
            },
            {
                id: 'topsis',
                name: 'TOPSIS - Technique for Order Preference',
                description: 'Técnica baseada na proximidade com a solução ideal positiva e distância da solução ideal negativa.',
                features: [
                    'Solução ideal positiva/negativa',
                    'Distância euclidiana',
                    'Coeficiente de proximidade',
                    'Ranking automático'
                ]
            },
            {
                id: 'electre',
                name: 'ELECTRE - Elimination and Choice',
                description: 'Método de eliminação e escolha baseado em relações de sobreclassificação.',
                features: [
                    'Relações de sobreclassificação',
                    'Limiares de preferência',
                    'Análise de concordância',
                    'Análise de discordância'
                ]
            },
            {
                id: 'promethee',
                name: 'PROMETHEE - Preference Ranking',
                description: 'Método de ordenação por preferência baseado em funções de preferência.',
                features: [
                    'Funções de preferência',
                    'Fluxos de preferência',
                    'Ranking parcial/completo',
                    'Análise GAIA'
                ]
            }
        ];

        // Critérios de avaliação técnica
        const technicalCriteria = [
            {
                name: 'Experiência da Equipe',
                weight: 25,
                description: 'Avaliação da experiência e qualificação da equipe técnica proposta'
            },
            {
                name: 'Metodologia Proposta',
                weight: 20,
                description: 'Adequação e qualidade da metodologia de desenvolvimento/execução'
            },
            {
                name: 'Cronograma de Execução',
                weight: 15,
                description: 'Viabilidade e detalhamento do cronograma apresentado'
            },
            {
                name: 'Recursos Técnicos',
                weight: 15,
                description: 'Adequação dos recursos técnicos e tecnológicos propostos'
            },
            {
                name: 'Qualidade da Proposta',
                weight: 10,
                description: 'Clareza, completude e organização da proposta técnica'
            },
            {
                name: 'Inovação e Diferencial',
                weight: 10,
                description: 'Soluções inovadoras e diferenciais competitivos apresentados'
            },
            {
                name: 'Sustentabilidade',
                weight: 5,
                description: 'Aspectos ambientais e de sustentabilidade da solução proposta'
            }
        ];

        // Dados das propostas para análise
        const proposalsData = [
            {
                id: 1,
                supplier: 'Alpha Tecnologia Ltda',
                cnpj: '11.222.333/0001-44',
                scores: {
                    experiencia: 85,
                    metodologia: 90,
                    cronograma: 80,
                    recursos: 88,
                    qualidade: 92,
                    inovacao: 75,
                    sustentabilidade: 70
                },
                totalScore: 0,
                ranking: 0
            },
            {
                id: 2,
                supplier: 'Beta Solutions S.A.',
                cnpj: '22.333.444/0001-55',
                scores: {
                    experiencia: 92,
                    metodologia: 88,
                    cronograma: 95,
                    recursos: 90,
                    qualidade: 85,
                    inovacao: 80,
                    sustentabilidade: 85
                },
                totalScore: 0,
                ranking: 0
            },
            {
                id: 3,
                supplier: 'Gamma Tech Inovação',
                cnpj: '33.444.555/0001-66',
                scores: {
                    experiencia: 78,
                    metodologia: 82,
                    cronograma: 75,
                    recursos: 85,
                    qualidade: 80,
                    inovacao: 95,
                    sustentabilidade: 90
                },
                totalScore: 0,
                ranking: 0
            }
        ];

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                loadAnalysisContent();
            }, 2000);
        });

        function loadAnalysisContent() {
            document.getElementById('loadingSection').style.display = 'none';
            document.getElementById('analysisContent').style.display = 'block';
            
            renderMethodologies();
            renderCriteria();
            calculateScores();
            renderComparisonTable();
            renderTechnicalAnalysis();
            renderRecommendation();
        }

        function renderMethodologies() {
            const grid = document.getElementById('methodologyGrid');
            
            grid.innerHTML = methodologies.map(method => `
                <div class="methodology-card ${method.selected ? 'selected' : ''}" 
                     onclick="selectMethodology('${method.id}')">
                    <h3>${method.name}</h3>
                    <p>${method.description}</p>
                    <ul class="methodology-features">
                        ${method.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                </div>
            `).join('');
        }

        function renderCriteria() {
            const grid = document.getElementById('criteriaGrid');
            
            grid.innerHTML = technicalCriteria.map(criteria => `
                <div class="criteria-item">
                    <h4>${criteria.name}</h4>
                    <div class="weight">Peso: ${criteria.weight}%</div>
                    <div class="description">${criteria.description}</div>
                </div>
            `).join('');
        }

        function calculateScores() {
            proposalsData.forEach(proposal => {
                let totalScore = 0;
                
                totalScore += (proposal.scores.experiencia * 0.25);
                totalScore += (proposal.scores.metodologia * 0.20);
                totalScore += (proposal.scores.cronograma * 0.15);
                totalScore += (proposal.scores.recursos * 0.15);
                totalScore += (proposal.scores.qualidade * 0.10);
                totalScore += (proposal.scores.inovacao * 0.10);
                totalScore += (proposal.scores.sustentabilidade * 0.05);
                
                proposal.totalScore = Math.round(totalScore * 100) / 100;
            });
            
            // Ordenar por pontuação e definir ranking
            proposalsData.sort((a, b) => b.totalScore - a.totalScore);
            proposalsData.forEach((proposal, index) => {
                proposal.ranking = index + 1;
            });
        }

        function renderComparisonTable() {
            const table = document.getElementById('comparisonTable');
            
            const headers = [
                'Fornecedor',
                'Experiência (25%)',
                'Metodologia (20%)',
                'Cronograma (15%)',
                'Recursos (15%)',
                'Qualidade (10%)',
                'Inovação (10%)',
                'Sustentabilidade (5%)',
                'Pontuação Total',
                'Ranking'
            ];
            
            const headerRow = `<tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>`;
            
            const dataRows = proposalsData.map(proposal => `
                <tr>
                    <td><strong>${proposal.supplier}</strong><br><small>${proposal.cnpj}</small></td>
                    <td class="score-cell">${getScoreClass(proposal.scores.experiencia)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.metodologia)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.cronograma)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.recursos)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.qualidade)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.inovacao)}</td>
                    <td class="score-cell">${getScoreClass(proposal.scores.sustentabilidade)}</td>
                    <td class="score-cell"><strong>${proposal.totalScore}</strong></td>
                    <td class="score-cell"><strong>${proposal.ranking}º</strong></td>
                </tr>
            `).join('');
            
            table.innerHTML = `<thead>${headerRow}</thead><tbody>${dataRows}</tbody>`;
        }

        function getScoreClass(score) {
            if (score >= 85) return `<span class="score-excellent">${score}</span>`;
            if (score >= 70) return `<span class="score-good">${score}</span>`;
            return `<span class="score-regular">${score}</span>`;
        }

        function renderTechnicalAnalysis() {
            const container = document.getElementById('technicalAnalysis');
            
            const analyses = [
                {
                    title: 'Análise de Experiência da Equipe',
                    metrics: {
                        'Média Geral': '85.0 pontos',
                        'Melhor Avaliação': 'Beta Solutions (92 pts)',
                        'Desvio Padrão': '7.2 pontos',
                        'Coeficiente de Variação': '8.5%'
                    },
                    description: `A análise da experiência da equipe revela que a Beta Solutions apresenta a equipe mais experiente, 
                    com profissionais seniores e certificações relevantes. A Alpha Tecnologia demonstra boa experiência técnica, 
                    enquanto a Gamma Tech, apesar de menor experiência média, compensa com especialização em tecnologias emergentes.`
                },
                {
                    title: 'Análise de Metodologia Proposta',
                    metrics: {
                        'Média Geral': '86.7 pontos',
                        'Melhor Avaliação': 'Alpha Tecnologia (90 pts)',
                        'Metodologia Predominante': 'Agile/Scrum',
                        'Conformidade PMBOK': '100%'
                    },
                    description: `A Alpha Tecnologia apresenta a metodologia mais robusta, com framework híbrido adaptado às necessidades 
                    do projeto. Todas as propostas demonstram aderência às melhores práticas de gerenciamento de projetos, 
                    com destaque para a implementação de metodologias ágeis.`
                },
                {
                    title: 'Análise de Recursos Técnicos',
                    metrics: {
                        'Média Geral': '87.7 pontos',
                        'Melhor Avaliação': 'Beta Solutions (90 pts)',
                        'Tecnologias Modernas': '95% das propostas',
                        'Cloud Computing': '100% das propostas'
                    },
                    description: `Todas as propostas demonstram adequação tecnológica excelente, com uso de tecnologias modernas 
                    e arquiteturas em nuvem. A Beta Solutions se destaca pela infraestrutura mais robusta e ferramentas 
                    de monitoramento avançadas.`
                }
            ];
            
            container.innerHTML = analyses.map(analysis => `
                <div class="analysis-item">
                    <h4>${analysis.title}</h4>
                    <div class="analysis-content">
                        <div class="analysis-metrics">
                            ${Object.entries(analysis.metrics).map(([key, value]) => `
                                <div class="metric">
                                    <span class="metric-label">${key}:</span>
                                    <span class="metric-value">${value}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="analysis-description">
                            <p>${analysis.description}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderRecommendation() {
            const container = document.getElementById('recommendationContent');
            const winner = proposalsData[0]; // Primeiro colocado
            
            container.innerHTML = `
                <div class="recommendation-text">
                    <p><strong>Com base na análise técnica detalhada utilizando a metodologia AHP (Analytic Hierarchy Process)</strong>, 
                    recomenda-se a contratação da <strong>${winner.supplier}</strong>.</p>
                    
                    <p>Esta recomendação baseia-se nos seguintes fatores:</p>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>Pontuação técnica superior:</strong> ${winner.totalScore} pontos de 100 possíveis</li>
                        <li><strong>Equipe experiente:</strong> ${winner.scores.experiencia} pontos em experiência</li>
                        <li><strong>Cronograma viável:</strong> ${winner.scores.cronograma} pontos em planejamento</li>
                        <li><strong>Recursos adequados:</strong> ${winner.scores.recursos} pontos em recursos técnicos</li>
                        <li><strong>Metodologia robusta:</strong> ${winner.scores.metodologia} pontos em metodologia</li>
                    </ul>
                    
                    <p>A proposta apresenta excelente relação entre qualidade técnica e viabilidade de execução, 
                    demonstrando capacidade para atender plenamente aos requisitos do Termo de Referência.</p>
                </div>
                
                <div class="recommendation-summary">
                    <div class="recommended-supplier">${winner.supplier}</div>
                    <div class="recommendation-score">${winner.totalScore}</div>
                    <div class="recommendation-label">Pontuação Técnica</div>
                </div>
            `;
        }

        function selectMethodology(methodId) {
            methodologies.forEach(method => {
                method.selected = method.id === methodId;
            });
            renderMethodologies();
            
            // Recalcular análise com nova metodologia
            setTimeout(() => {
                calculateScores();
                renderComparisonTable();
                renderTechnicalAnalysis();
                renderRecommendation();
            }, 500);
        }

        function exportAnalysis() {
            alert('Funcionalidade de exportação será implementada. A análise será exportada em formato PDF.');
        }

        function saveAsDraft() {
            const analysisData = {
                methodology: methodologies.find(m => m.selected)?.id || 'ahp',
                criteria: technicalCriteria,
                proposals: proposalsData,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('technical_analysis_draft', JSON.stringify(analysisData));
            alert('Análise salva como rascunho com sucesso!');
        }

        function finalizeAnalysis() {
            if (confirm('Deseja finalizar a análise técnica? Esta ação não poderá ser desfeita.')) {
                const analysisData = {
                    methodology: methodologies.find(m => m.selected)?.id || 'ahp',
                    criteria: technicalCriteria,
                    proposals: proposalsData,
                    recommendation: proposalsData[0],
                    status: 'FINALIZADA',
                    timestamp: new Date().toISOString()
                };
                
                localStorage.setItem('technical_analysis_final', JSON.stringify(analysisData));
                alert('Análise técnica finalizada com sucesso! Os dados foram salvos e a análise está pronta para envio ao requisitante.');
            }
        }

        function navigateTo(page) {
            const pages = {
                'dashboard': 'dashboard-comprador-funcional.html',
                'aprovacao-trs': 'dashboard-comprador-aprovacao-tr.html',
                'criar-processo': 'dashboard-comprador-criar-processo.html',
                'propostas-recebidas': 'dashboard-comprador-integrado.html',
                'analise-comparativa': 'dashboard-comprador-comparativo.html',
                'relatorios': 'dashboard-comprador-comparativo.html'
            };
            
            if (pages[page]) {
                window.location.href = pages[page];
            }
        }

        function logout() {
            if (confirm('Deseja sair do sistema?')) {
                localStorage.removeItem('user_session');
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>

